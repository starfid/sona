<!DOCTYPE html>
<html lang="en">
	<head>
		<title>App</title>
		<meta content="notranslate" name="google">
		<meta content="yes" name="mobile-web-app-capable">
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="#FFFFFF" name="theme-color" media="(prefers-color-scheme: light)">
		<meta content="#000000" name="theme-color" media="(prefers-color-scheme: dark)">
		<meta content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=0,viewport-fit=cover" name="viewport">
		<style>
			/*:root {--bhg:#0063E2;}*/:root {--bhg:#000000;}
			:root {
				--bg:#FAFAF9;	--cl:#000000;	--cl2:#858584;	--fn1:1.1vw;	--fn2:1.7vw;	--brC:#f3f3f2;		--nvB:#E1E0E1;
				--chg:#FFFFFF;	--cck:#000000;	--bck:#e7e7e5;	--mg:.7vw;	--mg2:calc(var(--fn2) / 2);		--dmy:5.2vw;
			}
			html {-webkit-tap-highlight-color: transparent;}
			body {margin:0;padding:0;font-family:arial;color:var(--cl);background:var(--bg)}
			main, section header {display:grid}
			main{grid-template-columns:23.5% auto 38.2%}
			section {position:relative; height:100vh; overflow:hidden;background:var(--bg)}
			label, #navSection form div.head {cursor:pointer;user-select:none;font-size:var(--fn1);}

			section fieldset {
				outline:none;border:none;scrollbar-width:none;margin:0;
				position:absolute; top:0; left:0; right:0; bottom:0; overflow-y:auto;
				padding:calc((2 * var(--mg)) + var(--fn2)) 0 0 0;
			}

			#navSection form.rows {display: grid;grid-template-columns:repeat(2, 1fr);gap:1vh;color:var(--cl2)}
			#navSection form * {display: block;box-sizing:border-box;}
			#navSection form label.select {border:solid 1px var(--nvB);}
			#navSection form div.head {color:var(--cl2);cursor:default;margin-left:var(--mg);font-weight:bolder;grid-column: 1 / -1;}
			#navSection form div.head:not(:first-of-type) {margin-top:calc(var(--mg) * 2)}
			#navSection form div.head:first-of-type {margin-top:calc((var(--mg) * 2) + (var(--mg) / 2))}

			#listSection {border-left:1px solid var(--brC); border-right:1px solid var(--brC);}
			#listSection form.rows label, #detailSection form.rows label {height:var(--dmy)}

			section header {
				position:absolute; top:0; left:0; right:0; z-index:1;padding:var(--mg);
				grid-template-columns:50% 50%;background-color:var(--bg);opacity:.97;
			}
			section header div label h1 {color:var(--cl2);margin:0 0 0 var(--mg);padding:0;font-size:var(--fn2);height:var(--fn2);line-height: calc(var(--fn2) - 1px);}
			section header div, .filters {display:flex;}
			section header div label {display:flex;align-items:center;}
			section header div label svg, .searchFrm label svg {
				width:var(--fn2); height:var(--fn2); cursor:pointer;
				stroke-width:4; stroke:var(--cl);fill:transparent;
			}
			section header div label svg {margin-right:calc((var(--mg) * 3) + 1px);}
			section header div label:first-child svg {margin-left:var(--mg);}
			section header .hRight label.last svg, section header .hRight label.thirdLast svg {margin-right:var(--mg);}
			section header .hRight label.secondLast svg {margin-right: var(--mg);}	
			section header .hRight {justify-content: flex-end;}
			section header .deskHid, section header .tabHid {display:none}

			.searchFrm, .searchFrm label, section fieldset form.filters label, .rows label.checked, 
				.rows label.focused, #navSection form label.select {border-radius:1vh;}
			.searchFrm {border:solid 1px var(--nvB);}
			.searchFrm .deskHid {visibility:hidden}
			.searchFrm label {padding:calc(var(--mg) * .68) var(--mg);display: flex;justify-content: space-between;}
			.searchFrm label input {
				border:0;outline:none;font-size:var(--fn1);background-color:var(--hbg);
				flex:1;min-width:0;color:var(--cl);max-width:78vw;
			}
			.searchFrm label input::-webkit-search-cancel-button {display: none;}

			section fieldset form {margin:0 var(--mg) var(--mg) var(--mg);padding:0}
			section fieldset form label {display:block;padding:var(--mg);}
			section fieldset form.filters {margin-left:0;margin-right:0;}
			section fieldset form.filters label {margin-right:var(--mg)}
			
			section fieldset form.filters label:first-child {margin-left:var(--mg)}
			section fieldset form.filters label:last-child {margin-right:var(--mg)}
			
			section fieldset form.rows label {border-bottom:solid 1px var(--brC)}

			.btn input[type=checkbox], .btn [type=radio], .select input[type=checkbox], .select [type=radio]{position: absolute;left: -9999px;}
			.checked {background-color:var(--bck);color:var(--cck)}
			.focused {background-color:var(--bhg);color:var(--chg)}
			.btn.checked, .btn.focused {background-color:transparent;}
			.btn.focused svg, .btn svg:hover, .btn.checked, .btn.checked, .iconOn {stroke:var(--bhg);stroke-width:8}
			.btn.focused svg.delBtn, .btn svg.delBtn:hover {stroke:red;stroke-width:8}
			.btn.focused svg.delBtn {stroke:red;}
			.searchFrm label.focused {background-color:transparent;color:var(--cl)}

			/*
			#listSection fieldset .rows, #detailSection fieldset .rows {
				display: grid;grid-template-columns:repeat(2, 1fr);gap:1vh;
			}
			#listSection fieldset .rows label, #detailSection fieldset .rows label {
				height: calc(var(--dmy) * 2.5);
			}
			*/

			@media screen and (max-width: 1175px){
				:root {
					--fn1:2vw; 	--fn2:2.5vw;	--brC:#FAF9F7;	--bg:#FFFFFF;
					--mg:1.1vw;	--mg2:calc(var(--fn2) / 2);	--dmy:7vw;
				}
				main {grid-template-columns:50% auto}
				.searchFrm .deskHid {visibility:visible}
				.searchFrm label {padding:var(--mg);}
				.searchFrm label input {padding:0; appearance: none;}
				#navSection {border-right:1px solid var(--brC);}
				#listSection header div:last-child label:not(.deskHid):not(.tabHid).last svg,
				#listSection header .hRight label.thirdLast svg {margin-right:calc((var(--mg) * 3) + 1px);}
				#listSection .visible, #navSection, .h1Hid {display:none}
				#listSection header .deskHid, #navSection header .deskHid {display:flex}
				#listSection {border-left:none;}
			}
			@media screen and (max-width: 500px) and (orientation: portrait){
				:root {
					--fn1:6vw; 	--fn2:7vw;	--dmy:25vw;
					--mg:3.2vw;	--mg2:calc(var(--fn2) / 2);
				}
				main {display:block}
				#listSection header div:last-child label:not(.deskHid):not(.tabHid).last svg
				section header div label svg {margin-right:calc(var(--mg) * 2);}
				section header .hRight label.secondLast svg {margin-right: calc(var(--mg) * 2);}
				.searchFrm label {padding:calc(var(--mg) * .92) var(--mg);}
				.filters {width:100vw;overflow: scroll; scrollbar-width:none;}
				#navSection, #listSection {border-right:none;}
				#detailSection div:first-child {display:none}
				#detailSection div:nth-child(2) {display:flex}
				#detailSection div.hRight label.last {display:none}
				#detailSection div.hRight label.secondLast svg {margin-right:var(--mg)}
				#navSection form div.head:first-of-type {margin-top:calc((var(--mg) * 2) + (var(--mg) / 2))}
				#detailSection {display:none}
				#listSection {display:block}
				.mobHid {display:none}
				section header .tabHid {display:flex}
				#dots {position:absolute;z-index:1;top:100px;left:100px;background-color:red;}
			}
			@media (prefers-color-scheme: dark) {
				:root {--bhg:#38474d}
				:root {
					--bg:#1E1E1E;	--cl:#afafaf;	--cl2:#575858;	--brC:#191919;		--nvB:#141414;
					--chg:#FFFFFF;	--cck:#929293;	--bck:#29292a;
				}
				@media screen and (max-width: 1175px){
					:root {	--bg:#000000;	--brC:#0a0a0a;	--bck:#232324; }
				}
			}
		</style>
	</head>
	<body ontouchstart>
		<main>
			<section id="navSection">
				<header>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="side">
							<svg viewbox="0 0 100 100">
								<path d="M10 90 H90 V10 H10 Z M40 90 V10 M18 20 H32 M18 30 H32 M18 40 H32" />
							</svg>
						</label>
					</div>
					<div class="hRight">
						<label class="btn tabHid last">
							<input type="radio" name="iBtn" data-btn="signout">
							<svg viewBox="0 0 100 100">
								<path d="M10 10 H60 V30 M60 70 V90 H10 V7.5" />
								<path d="M30 50 H97 M83 35 L97 50 L83 65" />
							</svg>
						</label>
					</div>
				</header>
				<fieldset>
					<form class="rows">
						<div class="head">Division 1</div>
							<label class="select"><input type="radio" name="nav" checked>Task 1</label>
						<div class="head">Division 2</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
							<label class="select"><input type="radio" name="nav">Task 2</label>
						<div class="head">Division 3</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
							<label class="select"><input type="radio" name="nav">Task 2</label>
							<label class="select"><input type="radio" name="nav">Task 3</label>
							<label class="select"><input type="radio" name="nav">Task 4</label>
						<div class="head">Division 4</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
							<label class="select"><input type="radio" name="nav">Task 2</label>
							<label class="select"><input type="radio" name="nav">Task 3</label>
							<label class="select"><input type="radio" name="nav">Task 4</label>
						<div class="head">Division 5</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
					</form>
				</fieldset>
			</section>
			<section id="listSection">
				<header>
					<div class="h1Hid">
						<label><h1>Starfid</h1></label>						
					</div>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="side">
							<svg viewbox="0 0 100 100">
								<path d="M10 90 H90 V10 H10 Z M40 90 V10 M18 20 H32 M18 30 H32 M18 40 H32" />
							</svg>
						</label>
					</div>
					<div class="hRight">
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="compose">
							<svg viewbox="0 0 100 100">
								<path d="M50 10 A40 40 0 1 1 50 90 A40 40 0 1 1 50 10 M50 25 V75 M25 50 H75" />
							</svg>
						</label>
						<label class="btn selIcon mobHid">
							<input type="radio" name="iBtn" data-btn="multi">
							<svg viewbox="0 0 100 100">
								<path d="M10 20H80V90H10ZM20 60L35 75L70 30M20 20V10H90V80H80"/>
							</svg>
						</label>
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="delete">
							<svg viewbox="0 0 100 100" class="delBtn">
								<path d="M33 10 H68 V20 H33 Z M20 20 H80 L75 90 H25 Z M10 20 H90 M33 30 L39 80 M50 30 V80 M67 30 L62 80" />
							</svg>
						</label>
						<label class="btn mobHid secondLast">
							<input type="radio" name="iBtn" data-btn="tiles">
							<svg viewbox="0 0 100 100">
								<path d="M10 10 H40 V40 H10 Z M60 10 H90 V40 H60 Z M10 60 H40 V90 H10 Z M60 60 H90 V90 H60 Z" />
							</svg>
						</label>
						<label class="btn tabHid last">
							<input type="radio" name="iBtn" data-btn="dots">
							<svg viewbox="0 0 100 100">
								<path d="M49 10 A40 40 0 1 1 48.9 10 M30 47 a3 3 0 1 0 0.1 0 M50 47 a3 3 0 1 0 0.1 0 M70 47 a3 3 0 1 0 0.1 0"/>
							</svg>
						</label>
					</div>
				</header>
				<fieldset>					
					<form class="searchFrm">
						<label class="select">
							<input type="search" name="item" placeholder="Search" ondblclick="this.value=''" autocomplete="off" autocorrect="off" spellcheck="false" autocapitalize="off">
							<svg viewbox="0 0 100 100" class="deskHid">
								<path d="M10 80H90V30H70L60 20H40L30 30H10Z M50 38a15 15 0 1 0 0 30a15 15 0 1 0 0-30z M70 40h1" />
							</svg>
						</label>
					</form>
					<form class="filters">
						<label class="select"><input type="radio" name="filter" checked>Filter1</label>
						<label class="select"><input type="radio" name="filter">Filter2</label>
						<label class="select"><input type="radio" name="filter">Filter3</label>
						<label class="select"><input type="radio" name="filter">Filter4</label>
						<label class="select"><input type="radio" name="filter">Filter5</label>
					</form>
					<form class="rows">
						<label class="select"><input type="checkbox" name="item" checked>Product 1</label>
						<label class="select"><input type="checkbox" name="item">Product 2</label>
						<label class="select"><input type="checkbox" name="item">Product 3</label>
						<label class="select"><input type="checkbox" name="item">Product 4</label>
						<label class="select"><input type="checkbox" name="item">Product 5</label>
						<label class="select"><input type="checkbox" name="item">Product 6</label>
						<label class="select"><input type="checkbox" name="item">Product 7</label>
						<label class="select"><input type="checkbox" name="item">Product 8</label>
						<label class="select"><input type="checkbox" name="item">Product 9</label>
						<label class="select"><input type="checkbox" name="item">Product 10</label>
						<label class="select"><input type="checkbox" name="item">Product 11</label>
						<label class="select"><input type="checkbox" name="item">Product 12</label>
						<label class="select"><input type="checkbox" name="item">Product 13</label>
						<label class="select"><input type="checkbox" name="item">Product 14</label>
						<label class="select"><input type="checkbox" name="item">Product 15</label>
						<label class="select"><input type="checkbox" name="item">Product 16</label>
						<label class="select"><input type="checkbox" name="item">Product 17</label>
						<label class="select"><input type="checkbox" name="item">Product 18</label>
						<label class="select"><input type="checkbox" name="item">Product 19</label>
						<label class="select"><input type="checkbox" name="item">Product 20</label>
						<label class="select"><input type="checkbox" name="item">Product 21</label>
						
					</form>
				</fieldset>
			</section>
			<section id="detailSection">
				<header>
					<div>
						<label><h1></h1></label>
					</div>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="back">
							<svg viewbox="0 0 100 100">
								<path d="M 50 10 L 10 50 L 50 90 M 10 50 L 90 50" />
							</svg>
						</label>
					</div>
					<div class="hRight">
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="save">
							<svg viewbox="0 0 100 100">
								<path d="M10,90 H90 V25 L75,10 H10Z M30,10 V35 H70 V10Z M20,90 V50 H80 V90Z M59,17 h3 v11 h-3Z" />
							</svg>
						</label>						
						
						<label class="btn selIcon mobHid">
							<input type="radio" name="iBtn" data-btn="multi">
							<svg viewbox="0 0 100 100">
								<path d="M10 20H80V90H10ZM20 60L35 75L70 30M20 20V10H90V80H80"/>
							</svg>
						</label>
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="delete">
							<svg viewbox="0 0 100 100" class="delBtn">
								<path d="M33 10 H68 V20 H33 Z M20 20 H80 L75 90 H25 Z M10 20 H90 M33 30 L39 80 M50 30 V80 M67 30 L62 80" />
							</svg>
						</label>
						<label class="btn tabHid secondLast">
							<input type="radio" name="iBtn" data-btn="dots">
							<svg viewbox="0 0 100 100">
								<path d="M49 10 A40 40 0 1 1 48.9 10 M30 47 a3 3 0 1 0 0.1 0 M50 47 a3 3 0 1 0 0.1 0 M70 47 a3 3 0 1 0 0.1 0"/>
							</svg>
						</label>
						<label class="btn last">
							<input type="radio" name="iBtn" data-btn="signout">
							<svg viewBox="0 0 100 100">
								<path d="M10 10 H60 V30 M60 70 V90 H10 V7.5" />
								<path d="M30 50 H97 M83 35 L97 50 L83 65" />
							</svg>
						</label>
					</div>
				</header>
				<fieldset>
					<form class="searchFrm">
						<label class="select">
							<input type="search" name="item" placeholder="Search" ondblclick="this.value=''" autocomplete="off" autocorrect="off" spellcheck="false" autocapitalize="off">
							<svg viewbox="0 0 100 100" class="deskHid">
								<path d="M10 80H90V30H70L60 20H40L30 30H10Z M50 38a15 15 0 1 0 0 30a15 15 0 1 0 0-30z M70 40h1" />
							</svg>
						</label>
					</form>
					<form class="filters">
						<label class="select"><input type="radio" name="filter" checked>Filter1</label>
						<label class="select"><input type="radio" name="filter">Filter2</label>
						<label class="select"><input type="radio" name="filter">Filter3</label>
						<label class="select"><input type="radio" name="filter">Filter4</label>
						<label class="select"><input type="radio" name="filter">Filter5</label>
					</form>
					<form class="rows">
						<label class="select"><input type="checkbox" name="copy" checked>Copy 1</label>
						<label class="select"><input type="checkbox" name="copy">Copy 2</label>
						<label class="select"><input type="checkbox" name="copy">Copy 3</label>
						<label class="select"><input type="checkbox" name="copy">Copy 4</label>
						<label class="select"><input type="checkbox" name="copy">Copy 5</label>
						<label class="select"><input type="checkbox" name="copy">Copy 6</label>
						<label class="select"><input type="checkbox" name="copy">Copy 7</label>
						<label class="select"><input type="checkbox" name="copy">Copy 8</label>
						<label class="select"><input type="checkbox" name="copy">Copy 9</label>
						<label class="select"><input type="checkbox" name="copy">Copy 10</label>
						<label class="select"><input type="checkbox" name="copy">Copy 11</label>
						<label class="select"><input type="checkbox" name="copy">Copy 12</label>
						<label class="select"><input type="checkbox" name="copy">Copy 13</label>
						<label class="select"><input type="checkbox" name="copy">Copy 14</label>
						<label class="select"><input type="checkbox" name="copy">Copy 15</label>
						<label class="select"><input type="checkbox" name="copy">Copy 16</label>
						<label class="select"><input type="checkbox" name="copy">Copy 17</label>
						<label class="select"><input type="checkbox" name="copy">Copy 18</label>
						<label class="select"><input type="checkbox" name="copy">Copy 19</label>
						<label class="select"><input type="checkbox" name="copy">Copy 20</label>
						<label class="select"><input type="checkbox" name="copy">Copy 21</label>
						
					</form>
				</fieldset>
			</section>
		</main>
		<script>
			const $$ = (s, c = document) => [...c.querySelectorAll(s)];
			const $ = (s, c = document) => c.querySelector(s);
			const selector = 'form label > input[type=checkbox], form label > input[type=radio], .searchFrm label > input[type=search], header label > input[type=radio]';
			const rowsCheck = '.rows label > input[type=checkbox]';
			const h1Txt = $('#listSection header div h1').innerText;
			let multiSelect = false;
			let selDown = true;
			let lastSection = null;

			function checkedFocus(el) {
				if(!el) return;
				el.checked = true;
				el.focus();
				const parentLabel = el.closest('label');
				const notSearch = el.closest('form') && !el.closest('form').classList.contains('searchFrm');
				if(!parentLabel) return;
				$$('input[name='+el.name+']', el.closest('form, header')).forEach(
					el => el.closest('label').classList.remove('checked')
				);
				if(el.checked && notSearch) parentLabel.classList.add('checked');
			}
			function clearbyArrow(section) {
				const selection = $$('.rows .focused',section);
				const totSelection = selection.length;
				if(totSelection>1){
					selection.forEach((label,index)=>{
						if ((index < totSelection - 1 && selDown) || (index > 0 && !selDown)) {
							label.classList.remove('focused','checked');
							$('input', label).checked = false;
						}
					});
					selDown = true; lastSection = null; clrTextSel(section);
				}
			}
			function clearbyClick(section, input){
				const selection = $$('.rows .focused',section);
				const totSelection = selection.length;
				if(totSelection>1 && input.closest('.rows')){
					selection.forEach(label=>{
						label.classList.remove('focused','checked');
						$('input', label).checked = false;
					});
					selDown = true; lastSection = null;
					input.closest('label').classList.add('focused','checked');
					clrTextSel(section);
				}
			}
			function totTextSel(section) {
				const totSelection = $$('.rows .focused',section).length;
				if(totSelection>1 && display($('#navSection'))!=='none'){
					$('h1',section).innerText = totSelection + ' Selected';
					if(section.id==='listSection'){
						//$('#detailSection header .hRight').style.visibility = 'hidden';
					}
				}
			}
			function clrTextSel(section) {
				const defText = section.id == 'listSection'?h1Txt:'';
				if($('h1',section) && display($('#navSection'))!=='none'){
					$('h1',section).innerText = defText;
					if(section.id==='listSection'){
						//$('#detailSection header .hRight').style.visibility = 'visible';
					}
				}
			}
			function display(el) {
				return window.getComputedStyle(el).display;
			}
			function sideToggle() {
				const nav = $('#navSection');
				const list = $('#listSection');
				const showNav = display(nav) !== 'block';
				nav.style.display = showNav ? 'block' : 'none';
				list.style.display = showNav ? 'none' : 'block';
				checkedFocus($(`${showNav ? '#navSection' : '#listSection'} header input`));
			}
			function handleChange(e) {
				if(!e.target.matches(selector)) return;
				const input = e.target;
				if(input.matches(rowsCheck) && lastSection) {
					clearbyClick(lastSection,input);
					clrTextSel(lastSection);
				}
				else {
					checkedFocus(e.target);
					if(input.name=='iBtn'){
						e.preventDefault();
					}
				}
			}
			function handleFocusIn(e) {
				if(!e.target.matches(selector)) return;
				const input = e.target;
				const iconSec = [];
				if(input.matches(selector)){
					const rows = ['item','copy'].includes(input.name);
					const sid = input.closest('section').id;
					if (multiSelect && rows) {
						$$('.iconOn').forEach(m=>{
							iconSec.push(m.closest('section').id);
						});
						if(input.closest('label').classList.contains('focused')){
							input.closest('label').classList.remove('checked','focused');
						}
						else if(iconSec.includes(sid)) {
							input.closest('label')?.classList.add('checked','focused');
						}
						totTextSel(input.closest('section'));
					}
					else if(!(multiSelect && !rows)){
						input.closest('label')?.classList.add('focused');
					}
					if(input.name=='iBtn'){
						e.preventDefault();
					}
				}
			}
			function handleFocusOut(e) {
				if(e.target.matches(selector) && !multiSelect){
					e.target.closest('label')?.classList.remove('focused');
				}
			}
			function handleKeyDown(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				if(input.type === 'radio') multiSelect = false;
				const parentLabel = input.closest('label');
				const parentForm = input.closest('form');
				const parentSection = input.closest('section');
				const holding = parentForm && (parentForm.classList.contains('rows') && input.type !== 'radio' && multiSelect);
				const toggleMulti = () => $('header .selIcon svg',parentSection).classList.toggle('iconOn');
					
				switch (e.key) {
					case 'ArrowDown':
						if(!parentForm) {
							if(!holding && !multiSelect && $$('.iconOn',parentSection).length > 0){
								toggleMulti();
							}
							e.preventDefault();
							checkedFocus($('form input', parentSection));
						}
						else if(parentSection.id === 'navSection'){
							e.preventDefault();
							const next = parentLabel.nextElementSibling;
							if (next?.nodeName === 'DIV') {
								next.nextElementSibling && checkedFocus($('input', next.nextElementSibling));
							}
							else if (next) {
								checkedFocus($('input', next));
							}
						}
						else if(holding){
							const nextInput = $('input',parentLabel.nextElementSibling);
							nextInput.checked = true; lastSection = parentSection;
							nextInput.focus();
							parentLabel.classList.add('focused');
							parentLabel.nextElementSibling.classList.add('checked');
							totTextSel(parentSection);
						}						
						else {
							e.preventDefault();
							const nextForm = parentForm.nextElementSibling;
							if(nextForm) {
								checkedFocus($('input', nextForm));
							}
							else if(parentLabel.classList.contains('select') && parentLabel.nextElementSibling) {
								checkedFocus($('input',parentLabel.nextElementSibling));
								clearbyArrow(parentSection);
								clrTextSel(parentSection);
							}
						}
					break;
					case 'ArrowUp':
						if(parentForm) {
							const isFirstChild = (input === $('input', parentForm)) || parentForm.classList.contains('filters');
							if(isFirstChild && $$('.rows .select.focused',parentSection).length > 1) {
								multiSelect = false;
								clearbyClick(parentSection,$('.rows .select',parentSection));
							}
							else if(isFirstChild) {
								e.preventDefault();
								multiSelect = false;
								const inputTarget = $('input',
									parentForm.previousElementSibling ||
									input.closest('fieldset').previousElementSibling
								);
								checkedFocus(inputTarget);
								const isHeader = inputTarget?.closest('div');								
								if(isHeader && display(isHeader) === 'none') {
									checkedFocus($('input', isHeader.nextElementSibling));
								}
							}
							else if(parentSection.id === 'navSection'){
								e.preventDefault();
								const prev = parentLabel.previousElementSibling;
								if (prev?.nodeName === 'DIV') {
									prev.previousElementSibling && checkedFocus($('input', prev.previousElementSibling));
								}
								else if (prev) {
									checkedFocus($('input', prev));
								}
							}
							else if(holding){
								const prevInput = $('input',parentLabel.previousElementSibling);
								prevInput.checked = true;
								prevInput.focus();
								parentLabel.classList.add('focused');
								parentLabel.previousElementSibling.classList.add('checked');
								selDown = false; lastSection = parentSection;
								totTextSel(parentSection);
							}
							else if(parentLabel.classList.contains('select') && parentLabel.previousElementSibling) {
								e.preventDefault();
								clearbyArrow(parentSection);
								clrTextSel(parentSection);
								checkedFocus($('input',parentLabel.previousElementSibling));
							}
						}
						else if(input.name === 'iBtn') {
							e.preventDefault();
						}
					break;
					case 'ArrowLeft':
					case 'ArrowRight':
						const listHidden = display($('#listSection')) === 'none';
						const mapLeft = { listSection: 'navSection', detailSection: listHidden?'navSection':'listSection' };
						const mapRight = { navSection: listHidden?'detailSection':'listSection', listSection: 'detailSection' };
						const map = e.key === 'ArrowLeft' ? mapLeft : mapRight;
						const atSelectable = parentForm && parentLabel.classList.contains('select') && (
							input.type === 'checkbox' ||
							(input.type === 'radio' && parentForm.classList.contains('rows')) ||
							(input.type === 'search' && input.value.length < 1)
						);
						
						if(holding){
							multiSelect = false;
							clearbyArrow(parentSection);
						}
						else if(!holding && !multiSelect && $$('.iconOn',parentSection).length > 0){
							toggleMulti();
						}
						else if(input.name === 'nav'){
							e.preventDefault();
							if(e.key === 'ArrowLeft'){
								const prev = parentLabel.previousElementSibling;
								if (prev?.nodeName === 'DIV') {
									prev.previousElementSibling && checkedFocus($('input', prev.previousElementSibling));
								}
								else if (prev) {
									checkedFocus($('input', prev));
								}
							}
							else if(e.key === 'ArrowRight'){								
								const labels = [...parentForm.querySelectorAll('label.select')];
								const idx = labels.indexOf(parentLabel);
								if (idx % 2 === 0) {
									checkedFocus($('#' + map[parentSection.id] + ' form.rows input:first-child'));
								} else {
									parentLabel.nextElementSibling && checkedFocus($('input', parentLabel.nextElementSibling));
								}
							}
						}
						else if(atSelectable && parentSection.id in map) {
							e.preventDefault();
							multiSelect = false;
							clearbyArrow(parentSection);
							checkedFocus($('#' + map[parentSection.id] + ' form.rows input:first-child'));
						}
					break;
					case 'Shift':
					//case 'Control':
						if(input.type==='checkbox') {
							multiSelect = true;
							toggleMulti();
						}
					break;
					case 'Enter':
						const name = input.name;
						const nav = $('#navSection');
						const list = $('#listSection');
						const detail = $('#detailSection');
						if(name=='iBtn'){
							const btn = input.dataset.btn;
							if(btn === 'side'){
								sideToggle(parentSection.id);
							}
							else if(btn === 'multi'){
								alert('Click only');
							}
							else if (btn === 'back') {
								list.style.display = 'block';
								detail.style.display = 'none';
								checkedFocus($('#listSection .rows input'));
							}
						}
						else if(name === 'item' && display(detail)==='none') {
							list.style.display = 'none';
							detail.style.display = 'block';
							checkedFocus($('#detailSection .rows input'));
						}
						else if(name === 'nav' && display(list)==='none') {
							nav.style.display = 'none';
							list.style.display = 'block';
							checkedFocus($('#listSection .rows input'));
						}
					break;
					case 'Delete':
						const totSelection = $$('.rows .checked',parentSection).length;
						if(parentSection.id !== 'navSection' && confirm('Delete ' + totSelection + ' selection in ' + parentSection.id)){
							//console.log(parentSection.id);
						}
					break;
				}
			}
			function handleKeyUp(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				switch (e.key) {
					case 'Shift':
					//case 'Control':
						multiSelect = false;
						const svg = $('header .selIcon svg',input.closest('section'));
						if(svg) svg.classList.remove('iconOn');
					break;
				}
			}
			function handleClick(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				if (e.clientX === 0 && e.clientY === 0) return;
				const section = input.closest('section').id;
				const label = input.closest('label');
				const list = $('#listSection');
				const detail = $('#detailSection');
				const nav = $('#navSection');
				lastSection !== null && clearbyClick(lastSection,input);
				
				if (label?.classList.contains('btn')) {
					e.preventDefault();
					const {btn} = input.dataset;
					if (btn === 'back') {
						list.style.display = 'block';
						detail.style.display = 'none';
					}
					else if (btn === 'side') {
						sideToggle(section);
					}
					else if (btn === 'delete') {
						//console.log('delete');
					}
					else if (btn === 'tiles') {
						//console.log('tiles');
					}
					else if (btn === 'dots') {
						//console.log('dots');
					}
					else if (btn === 'multi') {
						e.preventDefault();
						const svg = input.nextElementSibling;
						svg.classList.toggle('iconOn');
						if(!svg.classList.contains('iconOn') || $$('.rows .select.focused ',input.closest('section')).length > 1){
							multiSelect = false;
							svg.classList.remove('iconOn');
							label.classList.remove('focused');
							const sc = input.closest('section');
							const lastInp = $('.rows .focused input',sc);
							clearbyClick(sc,lastInp);
							checkedFocus(lastInp);
						}
						else {
							multiSelect = true;
						}
					}
					else if (btn === 'compose') {
						//console.log('compose');
					}
				}
				else if(input.closest('form.rows')){
					if (section === 'navSection' && display(list) === 'none') {
						list.style.display = 'block';
						nav.style.display = 'none';					
					}
					else if (detail && display(detail) === 'none' && section === 'listSection') {
						list.style.display = 'none';
						detail.style.display = 'block';
					}
				}				
			}
			function handleResize() {
				if(window.innerWidth>1175){
					$('#navSection').style.display = $('#listSection').style.display = $('#detailSection').style.display = 'block';
				}
				else if(window.innerWidth<1175 && window.innerWidth>500){
					$('#listSection').style.display = $('#detailSection').style.display = 'block';
					$('#navSection').style.display = 'none';
				}
				else if(window.innerWidth<500){
					$('#navSection').style.display = $('#detailSection').style.display = 'none';
					$('#listSection').style.display = 'block';
				}
			}
			
			document.addEventListener('change', handleChange);
			document.addEventListener('focusin', handleFocusIn);
			document.addEventListener('focusout', handleFocusOut);
			document.addEventListener('keydown', handleKeyDown);
			document.addEventListener('keyup', handleKeyUp);
			document.addEventListener('click', handleClick);
			document.addEventListener('visibilitychange', () => {
				if (document.hidden) multiSelect = false;
			});
			window.addEventListener('resize', handleResize);

			$$(selector.split(',').map(s => s.trim()).map(s => /checkbox|radio/.test(s) ? s + ':checked' : s).join(', ')).forEach(input => {
				if(input.checked) checkedFocus(input);
			});
		</script>
	</body>
</html>
