<!DOCTYPE html>
<html lang="en">
	<head>
		<title>App</title>
		<meta content="notranslate" name="google">
		<meta content="yes" name="mobile-web-app-capable">
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="#FFFFFF" name="theme-color" media="(prefers-color-scheme: light)">
		<meta content="#000000" name="theme-color" media="(prefers-color-scheme: dark)">
		<meta content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=0,viewport-fit=cover" name="viewport">
		<link rel="icon" href="data:,">
		<style>
			/*:root {--bhg:#0063E2;}*/:root {--bhg:#000000;}
			:root {
				--bg:#FFFFFF;	--cl:#000000;	--cl2:#858584;	--fn1:1.1vw;	--fn2:1.7vw;	--brC:#f3f3f2;		--nvB:#E1E0E1;
				--chg:#FFFFFF;	--cck:#000000;	--bck:#e7e7e5;	--mg:.7vw;	--mg2:calc(var(--fn2) / 2);		--dmy:5.2vw;
			}
			html {-webkit-tap-highlight-color: transparent;}
			body {margin:0;padding:0;font-family:arial;color:var(--cl);background:var(--bg)}
			main, section header {display:grid}
			main{grid-template-columns:23.5% auto 38.2%}
			section {position:relative; height:100vh; overflow:hidden;background:var(--bg)}
			label, #navSection form div.head {cursor:pointer;user-select:none;font-size:var(--fn1);}

			section fieldset {
				outline:none;border:none;scrollbar-width:none;margin:0;
				position:absolute; top:0; left:0; right:0; bottom:0; overflow-y:auto;
				padding:calc((2 * var(--mg)) + var(--fn2)) 0 0 0;
			}

			#navSection form.rows {display: grid;grid-template-columns:repeat(2, 1fr);gap:1vh;color:var(--cl2)}
			#navSection form * {display: block;box-sizing:border-box;}
			#navSection form label.select {border:solid 1px var(--nvB);}
			#navSection form div.head {color:var(--cl2);cursor:default;margin-left:var(--mg);font-weight:bolder;grid-column: 1 / -1;}
			#navSection form div.head:not(:first-of-type) {margin-top:calc(var(--mg) * 2)}
			#navSection form div.head:first-of-type {margin-top:calc((var(--mg) * 2) + (var(--mg) / 2));animation:navToggle .2s forwards}

			#listSection {border-left:1px solid var(--brC); border-right:1px solid var(--brC);}
			#listSection form.rows label, #detailSection form.rows label {height:var(--dmy)}

			section header {
				position:absolute; top:0; left:0; right:0; z-index:1;padding:var(--mg);
				grid-template-columns:50% 50%;background-color:var(--bg);opacity:.97;
			}
			section header div label h1 {color:var(--cl2);margin:0 0 0 var(--mg);padding:0;font-size:var(--fn2);height:var(--fn2);line-height: calc(var(--fn2) - 1px);}
			section header div, .filters {display:flex;}
			section header div label {display:flex;align-items:center;}
			label svg {
				width:var(--fn2); height:var(--fn2); cursor:pointer;
				stroke-width:4; stroke:var(--cl);fill:transparent;
			}
			section header div label svg {margin-right:calc((var(--mg) * 3) + 1px);}
			section header div label:first-child svg {margin-left:var(--mg);}
			section header .hRight label.last svg, section header .hRight label.thirdLast svg {margin-right:var(--mg);}
			section header .hRight label.secondLast svg {margin-right: var(--mg);}	
			section header .hRight {justify-content: flex-end;}
			section header .deskHid, section header .tabHid {display:none}

			.searchFrm, .searchFrm label, section fieldset form.filters label, .rows label.checked, 
				.rows label.focused, #navSection form label.select, #pop {border-radius:1vh;}
			.searchFrm {border:solid 1px var(--nvB);}
			.searchFrm .deskHid {visibility:hidden}
			.searchFrm label {padding:calc(var(--mg) * .68) var(--mg);display: flex;justify-content: space-between;}
			.searchFrm label input {
				border:0;outline:none;font-size:var(--fn1);background-color:var(--hbg);
				flex:1;min-width:0;color:var(--cl);max-width:78vw;
			}
			.searchFrm label input::-webkit-search-cancel-button {display: none;}

			section fieldset form {margin:0 var(--mg) var(--mg) var(--mg);padding:0}
			section fieldset form label {display:block;padding:var(--mg);}
			section fieldset form.filters {margin-left:0;margin-right:0;}
			section fieldset form.filters label {margin-right:var(--mg)}
			
			section fieldset form.filters label:first-child {margin-left:var(--mg)}
			section fieldset form.filters label:last-child {margin-right:var(--mg)}
			
			section fieldset form.rows label {border-bottom:solid 1px var(--brC)}

			.btn input[type=checkbox], .btn [type=radio], .select input[type=checkbox], .select input[type=radio]{position: absolute;left: -9999px;}
			.checked {background-color:var(--bck);color:var(--cck);}
			.focused {background-color:var(--bhg);color:var(--chg);}
			.btn.checked, .btn.focused {background-color:transparent;}
			.btn.focused svg, .btn svg:hover, .btn.checked, .btn.checked, .iconOn {stroke:var(--bhg);stroke-width:8}
			.btn.focused svg.delBtn, .btn svg.delBtn:hover {stroke:red;stroke-width:8}
			.btn.focused svg.delBtn {stroke:red;}
			.searchFrm label.focused {background-color:transparent;color:var(--cl)}
			/*
			#listSection fieldset .rows, #detailSection fieldset .rows {
				display:grid;grid-template-columns:repeat(2, 1fr);gap:1vh;
			}
			#listSection fieldset .rows label, #detailSection fieldset .rows label {
				height: calc(var(--dmy) * 2.5);
			}
			*/
			.layerToggle {display:block!important}
			#layer {position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.6);display:none;}
			#pop {
				position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);animation:popRising .3s forwards;
				background-color:var(--bg);width:38.2vw;height:80vh;box-sizing:border-box;
			}
			#pop .focused {background-color:var(--bg);color:var(--cl);font-weight:bolder}

			@keyframes popRising { from {top:51%;} to {top:50%;} }
			
			@media screen and (max-width: 1175px){
				:root {
					--fn1:2vw; 	--fn2:2.5vw;	--brC:#FAF9F7;	--bg:#FFFFFF;
					--mg:1.1vw;	--mg2:calc(var(--fn2) / 2);	--dmy:7vw;
				}
				main {grid-template-columns:50% auto}
				.searchFrm .deskHid {visibility:visible}
				.searchFrm label {padding:var(--mg);}
				.searchFrm label input {padding:0; appearance: none;}
				#navSection {border-right:1px solid var(--brC);}
				#listSection header div:last-child label:not(.deskHid):not(.tabHid).last svg,
				#listSection header .hRight label.thirdLast svg {margin-right:calc((var(--mg) * 3) + 1px);}
				#listSection .visible, #navSection, .h1Hid {display:none}
				#listSection header .deskHid, #navSection header .deskHid {display:flex}
				#listSection {border-left:none;}
				#pop {width:60vw}
				@keyframes navToggle {
					from {margin-top:calc(var(--mg) * 2)}
					to {margin-top:calc((var(--mg) * 2) + (var(--mg) / 2));}
				}
			}
			@media screen and (max-width: 770px) and (orientation: portrait){
				:root {
					--fn1:6vw; 	--fn2:7vw;	--dmy:25vw;
					--mg:3.2vw;	--mg2:calc(var(--fn2) / 2);	--tTop:50%;
				}
				main {display:block;background-color:#000000!important;min-height:60vh}
				#listSection header div:last-child label:not(.deskHid):not(.tabHid).last svg
				section header div label svg {margin-right:calc(var(--mg) * 2);}
				section header .hRight label.secondLast svg {margin-right: calc(var(--mg) * 2);}
				.searchFrm label {padding:calc(var(--mg) * .92) var(--mg);}
				.filters {width:100vw;overflow: scroll; scrollbar-width:none;}
				#navSection, #listSection {border-right:none;}
				#detailSection div:first-child {display:none}
				#detailSection div:nth-child(2) {display:flex}
				#detailSection div.hRight label.last {display:none}
				#detailSection div.hRight label.secondLast svg {margin-right:var(--mg)}
				#navSection form div.head:first-of-type {margin-top:calc((var(--mg) * 2) + (var(--mg) / 2))}
				#detailSection {display:none;position:absolute;z-index:1;top:0;width:100vw;}
				#listSection {display:block}
				#listSection header {grid-template-columns: 20% auto 20%;}
				section header div label h1 {margin:0;}
				#listSection .h1Hid {display:flex;margin:0 auto}

				.detailShowDetail {animation:detailShowDetail .3s forwards}
				.detailShowList {animation:detailShowList .35s forwards}
				.listShowDetail {animation:listShowDetail .7s forwards}
				.listShowList {animation:listShowList .3s forwards}
				.mobHid {display:none}
				#pop header div {padding:0 3vw}
				#pop fieldset form {display:block}
				#pop fieldset form label {
					border-top:solid 1px var(--bck);border-bottom:0;
					border-left:solid 1px var(--bck);border-right:solid 1px var(--bck);
					padding:var(--mg);border-radius:0;flex-direction: row-reverse;
				}
				#pop fieldset form label:first-child {
					border-top-left-radius:1vh;border-top-right-radius:1vh;
				}
				#pop fieldset form label:last-child {
					border-bottom:solid 1px var(--bck);
					border-bottom-left-radius:1vh;border-bottom-right-radius:1vh;
				}
				#pop fieldset form label span {text-transform: capitalize;}
				#pop .mobHid {display:flex;align-items:center;justify-content:space-between;}
				section header .tabHid {display:flex}
				#dots {position:absolute;z-index:1;top:100px;left:100px;}
				#pop {
					position:absolute;bottom:0;min-width:auto;transform:none;top:auto;left:auto;
                			background-color:white;width:100%;left:0;border-radius:2vh;border-width:0;
					border-bottom-left-radius:0;border-bottom-right-radius:0;
				}
				.sectionZoom {height:80vh;border-radius:var(--mg);animation:zooming .3s forwards}
				@keyframes zooming { from {transform:scale(1);} to {transform:scale(.94);} }
				@keyframes popRising { from {height:25%;} to {height:var(--tTop);} }
				@keyframes detailShowDetail { from {left:150px;} to {left:0;} }
				@keyframes detailShowList { from {left:30vw;} to {left:100vw;} }
				@keyframes listShowDetail { from {left:0;} to {left:-45px;} }
				@keyframes listShowList { from {left:-100px;} to {left:0;} }
			}
			@media (prefers-color-scheme: dark) {
				:root {--bhg:#38474d}
				:root {
					--bg:#1E1E1E;	--cl:#afafaf;	--cl2:#575858;	--brC:#191919;		--nvB:#141414;
					--chg:#FFFFFF;	--cck:#929293;	--bck:#29292a;
				}
				@media screen and (max-width: 1175px){
					:root {	--bg:#000000;	--brC:#0a0a0a;	--bck:#232324; }
				}
				.btn.focused svg, .btn svg:hover, .btn.checked, .btn.checked, .iconOn {stroke:var(--chg);}
				#layer {background-color: rgba(0,0,0,0.7);}
				#pop, #pop header {background-color:var(--bck)}
				#pop .focused {background-color:var(--bck);}				
			}
		</style>
	</head>
	<body ontouchstart>
		<main>
			<section id="navSection">
				<header>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="side">
							<svg viewbox="0 0 100 100">
								<path d="M10 10h80v5H10zM10 40h80v5H10zM10 70h50v5H10z"/>
							</svg>
						</label>
					</div>
					<div class="hRight">
						<label class="btn tabHid last">
							<input type="radio" name="iBtn" data-btn="signout">
							<svg viewBox="0 0 100 100">
								<path d="M10 10 H60 V30 M60 70 V90 H10 V7.5" />
								<path d="M30 50 H97 M83 35 L97 50 L83 65" />
							</svg>
						</label>
					</div>
				</header>
				<fieldset>
					<form class="rows">
						<div class="head">Division 1</div>
							<label class="select"><input type="radio" name="nav" checked>Task 1</label>
						<div class="head">Division 2</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
							<label class="select"><input type="radio" name="nav">Task 2</label>
						<div class="head">Division 3</div>
							<label class="select"><input type="radio" name="nav">Task 1</label><label class="select"><input type="radio" name="nav">Task 2</label>
							<label class="select"><input type="radio" name="nav">Task 3</label><label class="select"><input type="radio" name="nav">Task 4</label>
						<div class="head">Division 4</div>
							<label class="select"><input type="radio" name="nav">Task 1</label><label class="select"><input type="radio" name="nav">Task 2</label>
							<label class="select"><input type="radio" name="nav">Task 3</label><label class="select"><input type="radio" name="nav">Task 4</label>
						<div class="head">Division 5</div>
							<label class="select"><input type="radio" name="nav">Task 1</label>
					</form>
				</fieldset>
			</section>
			<section id="listSection">
				<header>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="side">
							<svg viewbox="0 0 100 100">
								<path d="M10 10h80v5H10zM10 40h80v5H10zM10 70h50v5H10z"/>
							</svg>
						</label>
					</div>
					<div class="h1Hid">
						<label><h1>Starfid</h1></label>						
					</div>
					<div class="hRight">
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="compose">
							<svg viewbox="0 0 100 100">
								<path d="M50 10 A40 40 0 1 1 50 90 A40 40 0 1 1 50 10 M50 25 V75 M25 50 H75" />
							</svg>
						</label>
						<label class="btn selIcon mobHid">
							<input type="radio" name="iBtn" data-btn="multi">
							<svg viewbox="0 0 100 100">
								<path d="M10 20H80V90H10ZM20 60L35 75L70 30M20 20V10H90V80H80"/>
							</svg>
						</label>
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="delete">
							<svg viewbox="0 0 100 100" class="delBtn">
								<path d="M33 10 H68 V20 H33 Z M20 20 H80 L75 90 H25 Z M10 20 H90 M33 30 L39 80 M50 30 V80 M67 30 L62 80" />
							</svg>
						</label>
						<label class="btn mobHid secondLast">
							<input type="radio" name="iBtn" data-btn="tiles">
							<svg viewbox="0 0 100 100">
								<path d="M10 10 H40 V40 H10 Z M60 10 H90 V40 H60 Z M10 60 H40 V90 H10 Z M60 60 H90 V90 H60 Z" />
								<!--<path d="M10 10h80v18H10zM10 41h80v18H10zM10 72h80v18H10z"/>-->
							</svg>
						</label>
						<label class="btn tabHid last">
							<input type="radio" name="iBtn" data-btn="dots">
							<svg viewbox="0 0 100 100">
								<path d="M49 10 A40 40 0 1 1 48.9 10 M30 47 a3 3 0 1 0 0.1 0 M50 47 a3 3 0 1 0 0.1 0 M70 47 a3 3 0 1 0 0.1 0"/>
							</svg>
						</label>
					</div>
				</header>
				<fieldset>					
					<form class="searchFrm">
						<label class="select">
							<input type="search" name="q" placeholder="Search" ondblclick="this.value=''" autocomplete="off" autocorrect="off" spellcheck="false" autocapitalize="off">
							<svg viewbox="0 0 100 100" class="deskHid">
								<path d="M10 80H90V30H70L60 20H40L30 30H10Z M50 38a15 15 0 1 0 0 30a15 15 0 1 0 0-30z M70 40h1" />
							</svg>
						</label>
					</form>
					<form class="filters">
						<label class="select"><input type="radio" name="filter" checked>Filter1</label><label class="select"><input type="radio" name="filter">Filter2</label>
						<label class="select"><input type="radio" name="filter">Filter3</label><label class="select"><input type="radio" name="filter">Filter4</label>
						<label class="select"><input type="radio" name="filter">Filter5</label>
					</form>
					<form class="rows">
						<label class="select"><input type="checkbox" name="item" checked>Product 1</label><label class="select"><input type="checkbox" name="item">Product 2</label>
						<label class="select"><input type="checkbox" name="item">Product 3</label><label class="select"><input type="checkbox" name="item">Product 4</label>
						<label class="select"><input type="checkbox" name="item">Product 5</label><label class="select"><input type="checkbox" name="item">Product 6</label>
						<label class="select"><input type="checkbox" name="item">Product 7</label><label class="select"><input type="checkbox" name="item">Product 8</label>
						<label class="select"><input type="checkbox" name="item">Product 9</label><label class="select"><input type="checkbox" name="item">Product 10</label>
						<label class="select"><input type="checkbox" name="item">Product 11</label><label class="select"><input type="checkbox" name="item">Product 12</label>
						<label class="select"><input type="checkbox" name="item">Product 13</label><label class="select"><input type="checkbox" name="item">Product 14</label>
						<label class="select"><input type="checkbox" name="item">Product 15</label><label class="select"><input type="checkbox" name="item">Product 16</label>
						<label class="select"><input type="checkbox" name="item">Product 17</label><label class="select"><input type="checkbox" name="item">Product 18</label>
						<label class="select"><input type="checkbox" name="item">Product 19</label><label class="select"><input type="checkbox" name="item">Product 20</label>
						<label class="select"><input type="checkbox" name="item">Product 21</label>
						
					</form>
				</fieldset>
			</section>
			<section id="detailSection">
				<header>
					<div>
						<label><h1></h1></label>
					</div>
					<div class="deskHid">
						<label class="btn">
							<input type="radio" name="iBtn" data-btn="back">
							<svg viewbox="0 0 100 100">
								<path d="M 50 10 L 10 50 L 50 90 M 10 50 L 90 50" />
							</svg>
						</label>
					</div>
					<div class="hRight">
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="compose">
							<svg viewbox="0 0 100 100">
								<path d="M50 10 A40 40 0 1 1 50 90 A40 40 0 1 1 50 10 M50 25 V75 M25 50 H75" />
							</svg>
						</label>
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="save">
							<svg viewbox="0 0 100 100">
								<path d="M10,90 H90 V25 L75,10 H10Z M30,10 V35 H70 V10Z M20,90 V50 H80 V90Z M59,17 h3 v11 h-3Z" />
							</svg>
						</label>
						<label class="btn selIcon mobHid">
							<input type="radio" name="iBtn" data-btn="multi">
							<svg viewbox="0 0 100 100">
								<path d="M10 20H80V90H10ZM20 60L35 75L70 30M20 20V10H90V80H80"/>
							</svg>
						</label>
						<label class="btn mobHid">
							<input type="radio" name="iBtn" data-btn="delete">
							<svg viewbox="0 0 100 100" class="delBtn">
								<path d="M33 10 H68 V20 H33 Z M20 20 H80 L75 90 H25 Z M10 20 H90 M33 30 L39 80 M50 30 V80 M67 30 L62 80" />
							</svg>
						</label>
						<label class="btn tabHid secondLast">
							<input type="radio" name="iBtn" data-btn="dots">
							<svg viewbox="0 0 100 100">
								<path d="M49 10 A40 40 0 1 1 48.9 10 M30 47 a3 3 0 1 0 0.1 0 M50 47 a3 3 0 1 0 0.1 0 M70 47 a3 3 0 1 0 0.1 0"/>
							</svg>
						</label>
						<label class="btn last">
							<input type="radio" name="iBtn" data-btn="signout">
							<svg viewBox="0 0 100 100">
								<path d="M10 10 H60 V30 M60 70 V90 H10 V7.5" />
								<path d="M30 50 H97 M83 35 L97 50 L83 65" />
							</svg>
						</label>
					</div>
				</header>
				<fieldset>
					<form class="searchFrm">
						<label class="select">
							<input type="search" name="q" placeholder="Search" ondblclick="this.value=''" autocomplete="off" autocorrect="off" spellcheck="false" autocapitalize="off">
							<svg viewbox="0 0 100 100" class="deskHid">
								<path d="M10 80H90V30H70L60 20H40L30 30H10Z M50 38a15 15 0 1 0 0 30a15 15 0 1 0 0-30z M70 40h1" />
							</svg>
						</label>
					</form>
					<form class="filters">
						<label class="select"><input type="radio" name="filter" checked>Filter1</label><label class="select"><input type="radio" name="filter">Filter2</label>
						<label class="select"><input type="radio" name="filter">Filter3</label><label class="select"><input type="radio" name="filter">Filter4</label>
						<label class="select"><input type="radio" name="filter">Filter5</label>
					</form>
					<form class="rows">
						<label class="select"><input type="checkbox" name="copy" checked>Copy 1</label><label class="select"><input type="checkbox" name="copy">Copy 2</label>
						<label class="select"><input type="checkbox" name="copy">Copy 3</label><label class="select"><input type="checkbox" name="copy">Copy 4</label>
						<label class="select"><input type="checkbox" name="copy">Copy 5</label><label class="select"><input type="checkbox" name="copy">Copy 6</label>
						<label class="select"><input type="checkbox" name="copy">Copy 7</label><label class="select"><input type="checkbox" name="copy">Copy 8</label>
						<label class="select"><input type="checkbox" name="copy">Copy 9</label><label class="select"><input type="checkbox" name="copy">Copy 10</label>
						<label class="select"><input type="checkbox" name="copy">Copy 11</label><label class="select"><input type="checkbox" name="copy">Copy 12</label>
						<label class="select"><input type="checkbox" name="copy">Copy 13</label><label class="select"><input type="checkbox" name="copy">Copy 14</label>
						<label class="select"><input type="checkbox" name="copy">Copy 15</label><label class="select"><input type="checkbox" name="copy">Copy 16</label>
						<label class="select"><input type="checkbox" name="copy">Copy 17</label><label class="select"><input type="checkbox" name="copy">Copy 18</label>
						<label class="select"><input type="checkbox" name="copy">Copy 19</label><label class="select"><input type="checkbox" name="copy">Copy 20</label>
						<label class="select"><input type="checkbox" name="copy">Copy 21</label>
					</form>
				</fieldset>
			</section>
		</main>
		<div id="layer">
			<section id="pop">
				<header>
					<div>
						<label class="btn select">
							<input type="radio" name="iBtn" data-btn="popCancel">
							Cancel
						</label>
					</div>
					<div class="hRight">
						<label class="btn select">
							<input type="radio" name="iBtn" data-btn="popSend">
							Send
						</label>
					</div>
				</header>
				<fieldset></fieldset>
			</section>
		</div>
		<script>
			const $$ = (s, c = document) => [...c.querySelectorAll(s)];
			const $ = (s, c = document) => c.querySelector(s);
			const selector = 'form label > input[type=checkbox], form label > input[type=radio], .searchFrm label > input[type=search], header label > input[type=radio]';
			const navSec = $('#navSection');
			const listSec = $('#listSection');
			const detSec = $('#detailSection');
			const rowsCheck = '.rows label > input[type=checkbox]';
			const h1Txt = $('header div h1',listSec).innerText;
			const bgCol = getComputedStyle(document.documentElement).getPropertyValue('--bg');
			const toggleLayer = () => $('#layer').classList.toggle('layerToggle');
			const display = (el) => {return window.getComputedStyle(el).display;}
			const leftPos = (el) => {return window.getComputedStyle(el).left;}
			
			let multiSelect = false;
			let selDown = true;
			let lastSection = null;

			function setPop(percent){
				$('#pop header .hRight label').style.visibility = 'hidden';
				//$('main').style.backgroundColor = '#000000';
				$('meta[name="theme-color"]').setAttribute('content','#000000');
				document.documentElement.style.setProperty("--tTop", percent);
				toggleLayer();
				if(leftPos(listSec)==='0px'){
					listSec.style.display = 'block';
					listSec.classList.add('sectionZoom');
					listSec.classList.remove('listShowList');
					section = listSec;
				}
				else {
					listSec.style.display = 'none';
					detSec.classList.add('sectionZoom');
					detSec.classList.remove('detailShowDetail');
					section = detSec;
				}
			}
			function buttonDots(){
				setPop('50%');
				checkedFocus($('#pop input'));
				$('#pop fieldset').innerHTML = "<form><form>";
				$$('header .hRight .mobHid',section).forEach(lbl=>{
					$('#pop fieldset form').appendChild(lbl.cloneNode(true));
				});
				$$('#pop fieldset form label').forEach(lbl=>{
					const label = document.createElement('span');
					label.innerText = $('input',lbl).dataset.btn;
					lbl.appendChild(label);
				});
			}
			function buttonMulti(e){
				e.preventDefault();
				const input = e.target;
				const label = input.closest('label');
				const svg = input.nextElementSibling;
				const section = input.closest('section');
				if(section.id==='pop'){
					buttonCancel(input);
				}
				svg.classList.toggle('iconOn');
				if(!svg.classList.contains('iconOn') || $$('.rows .select.focused ',section).length > 1){
					multiSelect = false;
					svg.classList.remove('iconOn');
					label.classList.remove('focused');					
					const lastInp = $('.rows .focused input,.rows .checked input',section);
					clearbyClick(section,lastInp);
					checkedFocus(lastInp);
				}
				else {
					multiSelect = true;
				}
			}
			function buttonCompose(input){
				const lastSection = input.closest('section');
				if(lastSection.id==='pop'){
					buttonCancel(input);
					setTimeout(()=>{
						setPop('96%');
					},100);
				}
				else {
					cancelMulti(input);
					$('#pop header .hRight label').style.visibility = 'visible';
					toggleLayer();
					checkedFocus($('#pop input'));
				}
			}
			function buttonCancel(input) {
				toggleLayer();
				$('#pop fieldset form').parentNode.removeChild($('#pop fieldset form'));
				//$('main').style.backgroundColor = bgCol;
				const metaTheme = document.querySelector('meta[name="theme-color"]');
				if (metaTheme) metaTheme.setAttribute('content', bgCol);
				let target = null;
				if (display(navSec) === 'none') {
					target = (display(listSec) === 'block') ? listSec : detSec;
				}
				else {
					target = lastSection;
				}
				if(target) {
					target.classList.remove('sectionZoom');
					const inputDots = $('header input[data-btn=dots]',target);
					if($('header input[data-btn=dots]',target) && display(inputDots.closest('label')) === 'flex'){
						checkedFocus(inputDots);
					}
					else {
						checkedFocus($('header input[data-btn=compose]',target));
					}
				}
			}
			function buttonBack(input){
				listSec.style.display = 'block';
				listSec.classList.remove('listShowDetail');
				listSec.classList.add('listShowList');
				listSec.style.display = 'block';
				detSec.classList.remove('detailShowDetail');
				detSec.classList.add('detailShowList');
				checkedFocus($('header input[data-btn=side]',listSec));
				listSec.addEventListener('animationend', () => {
					listSec.classList.remove('listShowList');
				}, { once: true });
				detSec.addEventListener('animationend', () => {
					detSec.classList.remove('detailShowList');
					detSec.style.display = 'none';
				}, { once: true });
			}
			function buttonDelete(input){
				if((input.name === 'item' || input.name === 'copy') || input.dataset.btn === 'delete') setTimeout(()=>{
					const section = input.closest('section');
					const selection = $$('.rows .focused,.rows .checked',section);
					const totSelection = selection.length || 1;
					if(section !== 'navSection' && confirm('Delete ' + totSelection + ' selection in ' + section.id)){
						selection.forEach(label=>{
							label.parentNode.removeChild(label);
						});
					}
					cancelMulti(input);
					checkedFocus($('.rows input',section));
				},200);
			}
			function buttonSide() {
				const showNav = display(navSec) !== 'block';
				listSec.classList.remove('listShowList');
				navSec.style.display = showNav ? 'block' : 'none';
				listSec.style.display = showNav ? 'none' : 'block';
				checkedFocus($(`${showNav ? '#navSection' : '#listSection'} header input`));
			}
			function checkedFocus(el) {
				if(!el) return;
				el.checked = true;
				el.focus();
				const parentLabel = el.closest('label');
				const notSearch = el.closest('form') && !el.closest('form').classList.contains('searchFrm');
				if(!parentLabel) return;
				$$('input[name='+el.name+']', el.closest('form, header')).forEach(
					el => el.closest('label').classList.remove('checked')
				);
				if(el.checked && notSearch) parentLabel.classList.add('checked');
			}
			function clearbyArrow(section) {
				const selection = $$('.rows .focused',section);
				const totSelection = selection.length;
				selection.forEach((label,index)=>{
					if ((index < totSelection - 1 && selDown) || (index > 0 && !selDown)) {
						label.classList.remove('focused','checked');
						$('input', label).checked = false;
					}
				});
				selDown = true; lastSection = null; clrTextSel(section);
			}
			function clearbyClick(section, input){
				const selection = $$('.rows .focused',section);
				const totSelection = selection.length;	
				selection.forEach(label=>{
					label.classList.remove('focused','checked');
					$('input', label).checked = false;
				});
				clrTextSel(section);
				selDown = true; lastSection = null;
				if(input.name == 'iBtn'){
					checkedFocus($('.rows input',section));
				}
				else {
					input.closest('label').classList.add('focused','checked');
				}
			}
			function totTextSel(section) {
				const totSelection = $$('.rows .focused',section).length;
				if(totSelection>1 && display(navSec)!=='none'){
					$('h1',section).innerText = totSelection + ' Selected';
					if(section.id==='listSection'){
						//$('#detailSection header .hRight').style.visibility = 'hidden';
					}
				}
			}
			function clrTextSel(section) {
				if(!section) return;
				const defText = section.id == 'listSection'?h1Txt:'';
				if($('h1',section) && display(navSec)!=='none'){
					$('h1',section).innerText = defText;
					if(section.id==='listSection'){
						//$('#detailSection header .hRight').style.visibility = 'visible';
					}
				}
			}
			function cancelMulti(input) {
				if(input.closest('section')) {					
					const lbl = $('.selIcon',input.closest('section'));
					$('svg',lbl).classList.remove('iconOn');
					multiSelect = false;
					lbl.classList.remove('focused');
					clearbyClick(input.closest('section'),input);
				}
				else {
					checkedFocus($((lastSection?'#'+lastSection.id:'#listSection') + ' .rows input'));
				}
			}
			function handleChange(e) {
				if(!e.target.matches(selector)) return;
				const input = e.target;
				if(input.matches(rowsCheck) && lastSection) {
					clearbyClick(lastSection,input);
					clrTextSel(lastSection);
				}
				else {
					checkedFocus(e.target);
					if(input.name=='iBtn'){
						e.preventDefault();
					}
				}
			}
			function handleFocusIn(e) {
				if(!e.target.matches(selector)) return;
				const input = e.target;
				const iconSec = [];
				if(input.matches(selector)){
					const rows = ['item','copy'].includes(input.name);
					const sid = input.closest('section').id;
					if (multiSelect && rows) {
						$$('.iconOn').forEach(m=>{
							iconSec.push(m.closest('section').id);
						});
						if(input.closest('label').classList.contains('focused')){
							input.closest('label').classList.remove('checked','focused');
						}
						else if(iconSec.includes(sid)) {
							input.closest('label')?.classList.add('checked','focused');
						}
						totTextSel(input.closest('section'));
					}
					else if(!(multiSelect && !rows)){
						input.closest('label')?.classList.add('focused');
					}
					if(input.name=='iBtn'){
						e.preventDefault();
					}
				}
			}
			function handleFocusOut(e) {
				if(e.target.matches(selector) && !multiSelect){
					e.target.closest('label')?.classList.remove('focused');
				}
			}
			function handleKeyDown(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				if(input.type === 'radio') multiSelect = false;
				const parentLabel = input.closest('label');
				const parentForm = input.closest('form');
				const parentSection = input.closest('section');
				const holding = parentForm && (parentForm.classList.contains('rows') && input.type !== 'radio' && multiSelect);
				const toggleMulti = () => $('header .selIcon svg',parentSection).classList.toggle('iconOn');
				
				switch (e.key) {
					case 'ArrowDown':
						if(!parentForm) {
							if(!holding && !multiSelect && $$('.iconOn',parentSection).length > 0){
								toggleMulti();
							}
							e.preventDefault();
							checkedFocus($('form input', parentSection));
						}
						else if(parentSection.id === 'navSection'){
							e.preventDefault();
							const next = parentLabel.nextElementSibling;
							if (next?.nodeName === 'DIV') {
								next.nextElementSibling && checkedFocus($('input', next.nextElementSibling));
							}
							else if (next) {
								checkedFocus($('input', next));
							}
						}
						else if(holding){
							const nextInput = $('input',parentLabel.nextElementSibling);
							nextInput.checked = true; lastSection = parentSection;
							nextInput.focus();
							parentLabel.classList.add('focused');
							parentLabel.nextElementSibling.classList.add('checked');
							totTextSel(parentSection);
						}						
						else {
							e.preventDefault();
							const nextForm = parentForm.nextElementSibling;
							if(nextForm) {
								checkedFocus($('input', nextForm));
							}
							else if(parentLabel.classList.contains('select') && parentLabel.nextElementSibling) {
								checkedFocus($('input',parentLabel.nextElementSibling));
								clearbyArrow(parentSection);
								clrTextSel(parentSection);
							}
						}
					break;
					case 'ArrowUp':
						if(parentForm) {
							const isFirstChild = (input === $('input', parentForm)) || parentForm.classList.contains('filters');
							if(isFirstChild && $$('.rows .select.focused',parentSection).length > 1) {
								multiSelect = false;
								clearbyClick(parentSection,$('.rows .select',parentSection));
							}
							else if(isFirstChild) {
								e.preventDefault();
								multiSelect = false;
								const inputTarget = $('input',
									parentForm.previousElementSibling ||
									input.closest('fieldset').previousElementSibling
								);
								checkedFocus(inputTarget);
								const isHeader = inputTarget?.closest('div');								
								if(isHeader && display(isHeader) === 'none') {
									checkedFocus($('input', isHeader.nextElementSibling));
								}
							}
							else if(parentSection.id === 'navSection'){
								e.preventDefault();
								const prev = parentLabel.previousElementSibling;
								if (prev?.nodeName === 'DIV') {
									prev.previousElementSibling && checkedFocus($('input', prev.previousElementSibling));
								}
								else if (prev) {
									checkedFocus($('input', prev));
								}
							}
							else if(holding){
								const prevInput = $('input',parentLabel.previousElementSibling);
								prevInput.checked = true;
								prevInput.focus();
								parentLabel.classList.add('focused');
								parentLabel.previousElementSibling.classList.add('checked');
								selDown = false; lastSection = parentSection;
								totTextSel(parentSection);
							}
							else if(parentLabel.classList.contains('select') && parentLabel.previousElementSibling) {
								e.preventDefault();
								clearbyArrow(parentSection);
								clrTextSel(parentSection);
								checkedFocus($('input',parentLabel.previousElementSibling));
							}
						}
						else if(input.name === 'iBtn') {
							e.preventDefault();
						}
					break;
					case 'ArrowLeft':
					case 'ArrowRight':
						const listHidden = display(listSec) === 'none';
						const mapLeft = { listSection: 'navSection', detailSection: listHidden?'navSection':'listSection' };
						const mapRight = { navSection: listHidden?'detailSection':'listSection', listSection: 'detailSection' };
						const map = e.key === 'ArrowLeft' ? mapLeft : mapRight;
						const atSelectable = parentForm && parentLabel.classList.contains('select') && (
							input.type === 'checkbox' ||
							(input.type === 'radio' && parentForm.classList.contains('rows')) ||
							(input.type === 'search' && input.value.length < 1)
						);
						if(holding){
							multiSelect = false;
							clearbyArrow(parentSection);
						}
						else if(!holding && !multiSelect && $$('.iconOn',parentSection).length > 0){
							toggleMulti();
						}
						else if(input.name === 'nav'){
							e.preventDefault();
							if(e.key === 'ArrowLeft'){
								const prev = parentLabel.previousElementSibling;
								if (prev?.nodeName === 'DIV') {
									prev.previousElementSibling && checkedFocus($('input', prev.previousElementSibling));
								}
								else if (prev) {
									checkedFocus($('input', prev));
								}
							}
							else if(e.key === 'ArrowRight'){								
								const labels = [...parentForm.querySelectorAll('label.select')];
								const idx = labels.indexOf(parentLabel);
								if (idx % 2 === 0) {
									checkedFocus($('#' + map[parentSection.id] + ' form.rows input:first-child'));
								} else {
									parentLabel.nextElementSibling && checkedFocus($('input', parentLabel.nextElementSibling));
								}
							}
						}
						else if(atSelectable && parentSection.id in map) {
							e.preventDefault();
							multiSelect = false;
							clearbyArrow(parentSection);
							checkedFocus($('#' + map[parentSection.id] + ' form.rows input:first-child'));
						}
					break;
					case 'Escape':
						buttonCancel(input);
					break;
					case 'Shift':
					//case 'Control':
						if(input.type==='checkbox') {
							multiSelect = true;
							toggleMulti();
						}
					break;
					case 'Enter':
						if (input.name === 'iBtn') {
							const { btn } = input.dataset;
							switch (btn) {
								case 'side':	buttonSide(); break;
								case 'compose':	buttonCompose(input); break;
								case 'dots':	buttonDots(); break;
								case 'back':	buttonBack(input); break;
								case 'popCancel':
								case 'popSend':	buttonCancel(input); break;
							}
						}
						else if(input.name === 'item' && (display(detSec) === 'none' || leftPos(detSec) > '200px')) {

							listSec.classList.remove('listShowList');
							listSec.classList.add('listShowDetail');
							detSec.classList.remove('detailShowList');
							detSec.classList.add('detailShowDetail');
							detSec.style.display = 'block';
							checkedFocus($('.rows input',detSec));

							listSec.addEventListener('animationend', () => {
								listSec.classList.remove('listShowDetail');
								listSec.style.display = 'none';
							}, { once: true });
							detSec.addEventListener('animationend', () => {
								detSec.classList.remove('detailShowDetail');
							}, { once: true });
						}
						else if(input.name === 'nav' && display(listSec)==='none') {
							navSec.style.display = 'none';
							listSec.style.display = 'block';
							checkedFocus($('.rows input',listSec));
						}
					break;
					case 'Delete':
						if(!(input.type==='text'||input.type==='search')) buttonDelete(input);
					break;
				}
			}
			function handleKeyUp(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				switch (e.key) {
					case 'Shift':
					//case 'Control':
						multiSelect = false;
						const svg = $('header .selIcon svg',input.closest('section'));
						if(svg && svg !== input.nextElementSibling){
							svg.classList.remove('iconOn');
							svg.closest('label').classList.remove('focused');
						}
					break;
				}
			}
			function handleClick(e) {
				const input = e.target;
				if(!input.matches(selector)) return;
				if (e.clientX === 0 && e.clientY === 0) return;
				const section = input.closest('section').id;
				const label = input.closest('label');
				lastSection !== null && clearbyClick(lastSection,input);
				if (label?.classList.contains('btn')) {
					e.preventDefault();
					const { btn } = input.dataset;
					switch (btn) {
						case 'back':	buttonBack(input); break;
						case 'side':	buttonSide(); break;
						case 'tiles':	cancelMulti(input); break;
						case 'delete':	buttonDelete(input); break;
						case 'compose':	buttonCompose(input); break;
						case 'dots':	buttonDots(); break;
						case 'multi':	buttonMulti(e); break;
						case 'popCancel':
						case 'popSend':	buttonCancel(input); break;
					}
				}
				else if (input.closest('form.rows')){
					if (section === 'navSection' && display(listSec) === 'none') {
						navSec.style.display = 'none';
						listSec.style.display = 'block';
					}
					else if (detSec && (display(detSec) === 'none' || leftPos(detSec) > '200px')) {						
						listSec.classList.remove('listShowList');
						listSec.classList.add('listShowDetail');
						detSec.classList.remove('detailShowList');
						detSec.classList.add('detailShowDetail');
						detSec.style.display = 'block';
						checkedFocus($('.rows input',detSec));
						$('.rows input',detSec).focus();
						listSec.addEventListener('animationend', () => {
							listSec.classList.remove('listShowDetail');
							listSec.style.display = 'none';
						}, { once: true });
						detSec.addEventListener('animationend', () => {
							detSec.classList.remove('detailShowDetail');
						}, { once: true });
					}
				}	
			}
			function handleResize() {
				if(window.innerWidth>1175){
					navSec.style.display = listSec.style.display = detSec.style.display = 'block';
				}
				else if(window.innerWidth<1175 && window.innerWidth>770){
					listSec.style.display = detSec.style.display = 'block';
					navSec.style.display = 'none';
				}
			}
			
			window.addEventListener('resize', handleResize);
			document.addEventListener('change', handleChange);
			document.addEventListener('focusin', handleFocusIn);
			document.addEventListener('focusout', handleFocusOut);
			document.addEventListener('keydown', handleKeyDown);
			document.addEventListener('keyup', handleKeyUp);
			document.addEventListener('click', handleClick);
			document.addEventListener('visibilitychange', () => {if (document.hidden) multiSelect = false;});

			$$(selector.split(',').map(s => s.trim()).map(s => /checkbox|radio/.test(s) ? s + ':checked' : s).join(', ')).forEach(input => {
				if(input.checked) checkedFocus(input);
			});
			$('#listSection .rows input').focus();
		</script>
	</body>
</html>
